library(MASS)
library(ggplot2)
require(gridExtra)
library(corrplot)



pca.computation <- function(dataset, numcomp=10){
  pca.data <- prcomp(dataset[,c(9:length(dataset))])
  pca.dataset <- data.frame(pca.data$x[,c(1:numcomp)])
  pca.dataset$label <- csvData2$label
  return(pca.dataset)
}

pca.computation.old <- function(dataset, numcomp=30){
  
  PCA1 <- prcomp(dataset[,c(9:ncol(dataset))])
  
  pca.dataset <- data.frame(PCA1$x[,c(1:numcomp)])
  pca.dataset$name <- dataset$name
  pca.dataset$label <- dataset$label
  pca.dataset$md5 <- dataset$md5
  pca.dataset$sha1 <- dataset$sha1
  pca.dataset$sha256 <- dataset$sha256
  pca.dataset$sha512 <- dataset$sha512
  
  return(pca.dataset)
}


pca.computation.detailed <- function(dataset, numcomp=30){
  
  PCA1 <- prcomp(dataset[,c(9:ncol(dataset))])
  
  pca.dataset <- data.frame(PCA1$x[,c(1:numcomp)])
  
  names(PCA1)
  
  
  pca.dataset$name <- dataset$name
  pca.dataset$label <- dataset$label
  pca.dataset$md5 <- dataset$md5
  pca.dataset$sha1 <- dataset$sha1
  pca.dataset$sha256 <- dataset$sha256
  pca.dataset$sha512 <- dataset$sha512
  
  return(pca.dataset)
}


pcaCharts <- function(x) {
  x.var <- x$sdev ^ 2
  x.pvar <- x.var/sum(x.var)
  print("proportions of variance:")
  print(x.pvar)
  
  par(mfrow=c(2,2))
  plot(x.pvar,xlab="Principal component", ylab="Proportion of variance explained", ylim=c(0,1), type='b')
  plot(cumsum(x.pvar),xlab="Principal component", ylab="Cumulative Proportion of variance explained", ylim=c(0,1), type='b')
  screeplot(x)
  screeplot(x,type="l")
  par(mfrow=c(1,1))
}


pcaCharts.simple <- function(x) {
  x.var <- x$sdev ^ 2
  x.pvar <- x.var/sum(x.var)
  #print("proportions of variance:")
  #print(x.pvar)
  
  par(mfrow=c(2,2))
  plot(x.pvar,xlab="Principal component", ylab="Proportion of variance explained", ylim=c(0,1), type='b')
  plot(cumsum(x.pvar),xlab="Principal component", ylab="Cumulative Proportion of variance explained", ylim=c(0,1), type='b')
  #screeplot(x)
  #screeplot(x,type="l")
  par(mfrow=c(1,1))
}
