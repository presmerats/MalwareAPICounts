setwd("/home/pau/Projectes/dakd-project/R")
source('exploration_functions.R')
csvData2 <- read.csv(file="data_20171231.csv", header=TRUE, sep=",")
csvData2 <- filter.minor.classes(csvData2)
library(MASS)
# remove id columns and compute pca
pca.data <- prcomp(csvData2[,c(9:length(csvData2))])
# extract the first 30 principal components
pca.dataset <- data.frame(pca.data$x[,c(1:30)])
# add label column back
pca.dataset$label <- csvData2$label
# compute an LDA model
lda.model <- lda(pca.dataset$label ~ ., data=pca.dataset)


#Coefficients and Proportion of trace:
lda.model

#stacked histogram
lda.values <- predict(lda.model)
head(lda.values)
par(mar = rep(2, 4))
ldahist(data=lda.values$x[,1], g=pca.dataset$label)
ldahist(data=lda.values$x[,2], g=pca.dataset$label)
ldahist(data=lda.values$x[,3], g=pca.dataset$label)



# scatterplot with ggplot2
df <- data.frame(LDA1=lda.values$x[,1], LDA2=lda.values$x[,2], class=lda.values$class, realc=pca.dataset$label )
ggplot(df, aes(x=LDA1, y=LDA2, color=factor(class))) +
  geom_point(size=1) 
 
df <- data.frame(LDA1=lda.values$x[,1], LDA3=lda.values$x[,3], class=lda.values$class, realc=pca.dataset$label )
ggplot(df, aes(x=LDA1, y=LDA3, color=factor(class))) +
  geom_point(size=1) 

        