library(MASS)

par(mfrow=c(1,1))
N <- 100

# First dataset should perform better with PCA, since the classes
# have the same mean; the discriminatory information is entirely due to the different covariances.

x1 <- rnorm(N)
y1 <- 4*rnorm(N)

x2 <- rnorm(N)
y2 <- rnorm(N)

a <- c(-10, 10)
b <- c(-10, 10)

plot(c(a, x1, x2), c(b, y1,y2), col=c(rep('white', 2),rep('green',N),rep('red',N)))

d1 <- data.frame(c(rep(1,N),rep(2,N)),c(x1,x2),c(y1,y2))

#x1 <- c(1:5)
#x2 <- c(3,3,3,3,3)
#dtest <- data.frame(c(rep(1,5)),c(x1,x2))

# Second dataset should perform better with LDA, since the classes
# are separable using the dimension exhibiting less variability

x3 <- 0.25*rnorm(N)+0.75
y3 <- 5*rnorm(N)

x4 <- 0.25*rnorm(N)-0.75
y4 <- 5*rnorm(N)

plot(c(a, x3, x4), c(b, y3,y4), col=c(rep('white', 2),rep('green',N),rep('red',N)))

d2 <- data.frame(c(rep(1,N),rep(2,N)),c(x3,x4),c(y3,y4))


# Let's check it. Compute PCA and LDA:

PCA1 <- prcomp(d1[-1])
PCA2 <- prcomp(d2[-1])


LDA1 <- lda(d1[c(2,3)],d1[,1])
LDA2 <- lda(d2[c(2,3)],d2[,1])


# Now we need to project the datasets in the new coordinates
# We just preserve the first PC because otherwise the 
# representation would be equivalent to the one without FS

d1PCA <- PCA1$x[,1]
d2PCA <- PCA2$x[,1]

PCA1
names(PCA1)
names(PCA1$x)
PCA1$x
# for LDA, this amounts to y = w^T x as seen in the slides

d1LDA <- d1[,2] * LDA1$scaling[1] + d1[,3] * LDA1$scaling[2]
d2LDA <- d2[,2] * LDA2$scaling[1] + d2[,3] * LDA2$scaling[2]

# Now compute the first projection direction for both methods

PCAslope1 <- PCA1$rotation[2,1]/PCA1$rotation[1,1]
PCAslope2 <- PCA2$rotation[2,1]/PCA2$rotation[1,1]
LDAslope1 <- LDA1$scaling[2]/LDA1$scaling[1]
LDAslope2 <- LDA2$scaling[2]/LDA2$scaling[1]

# And now we can perform the visualization:

par(mfrow=c(2,2))
plot(c(a, x1, x2), c(b, y1,y2), col=c(rep('white', 2),rep('green',N),rep('red',N)), main="Dataset 1 using PCA")
abline(0,PCAslope1,col='black',lwd=2)
#legend("topright",legend='DS1+PCA')
plot(c(a, x1, x2), c(b, y1,y2), col=c(rep('white', 2),rep('green',N),rep('red',N)), main="Dataset 1 using LDA")
abline(0,LDAslope1,col='black',lwd=2)
#legend("topright",legend='DS1+LDA')
plot(c(a, x3, x4), c(b, y3,y4), col=c(rep('white', 2),rep('green',N),rep('red',N)), main="Dataset 2 using PCA")
abline(0,PCAslope2,col='black',lwd=2)
#legend("topright",legend='DS2+PCA')
plot(c(a, x3, x4), c(b, y3,y4), col=c(rep('white', 2),rep('green',N),rep('red',N)), main="Dataset 2 using LDA")
abline(0,LDAslope2,col='black',lwd=2)
#legend("topright",legend='DS2+LDA')

